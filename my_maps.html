<!DOCTYPE html>
<html lang="en">
<head>
 <meta charset="UTF-8">
 <script defer src="https://use.fontawesome.com/releases/v5.0.8/js/all.js"></script>
 <link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.1/dist/leaflet.css"
	integrity="sha512-Rksm5RenBEKSKFjgI3a41vrjkw4EVPlJ3+OiI65vTjIdo9brlAacEuKOiQ5OFh7cOI1bkDwLqdLw3Zg0cRJAAQ=="
	crossorigin=""/>
 <script src="https://unpkg.com/leaflet@1.3.1/dist/leaflet.js"
   integrity="sha512-/Nsx9X4HebavoBvEBuyp3I7od5tA0UzAxs+j83KgC8PU0kgB4XiK4Lfe4y4cgBtaRJQEIFCW+oC506aPT2L1zw=="
   crossorigin=""></script>
 <link rel="stylesheet" href="https://unpkg.com/leaflet-routing-machine@latest/dist/leaflet-routing-machine.css" />
 <script src="https://unpkg.com/leaflet-routing-machine@latest/dist/leaflet-routing-machine.js"></script>
 <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick.min.css"/>
 <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick-theme.min.css"/>
 <link rel="stylesheet" href="bootstrap/dist/css/bootstrap.min.css" />
 <link rel="stylesheet" href="style/css/app.css" />
 <link rel="stylesheet" href="style/css/mymaps.css" />
 <title>My maps</title>
</head>
<body>

<header>
 
 <div class="container-fluid">
  <nav id="menu" class="navbar navbar-light">
   <div style="display: inline">
    <img src="style/img/logo.png" height="60" width="46">
    <h4 style="display: inline" id="app-name">Events Location</h4>
   </div>
   
		
	<div class="input-group-prepend">
	<input type="text" class="form-control" placeholder="Look for a map...">
		<div class="input-group-append">
		<button type="button" class="btn btn-outline-secondary"><i class="fa fa-search"></i></button>    
		</div>
	</div>
	<ul class="nav ">
    <li class="nav-item">
     <a class="nav-link" href="index.html">Home</a>
    </li>
    <li class="nav-item">
     <a class="nav-link " href="public.html">Public area</a>
    </li>
    <li class="nav-item">
     <a class="nav-link active" href="my_maps.html">My maps</a>
    </li>
    <!--<li class="nav-item dropdown">
     <a class="nav-link dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">Dropdown</a>
     <div class="dropdown-menu">
      <a class="dropdown-item" href="#one">one</a>
      <a class="dropdown-item" href="#two">two</a>
      <div role="separator" class="dropdown-divider"></div>
      <a class="dropdown-item" href="#three">three</a>
     </div>
    </li>-->
   </ul>
  </nav>
 </div>
</header>


<div class="container-fluid">
	<div id="mapid"></div>
	<div id="markplace">	
	</div>
	
  <div class="row"> 
  
	<button type="button" class="btn btn-light" id="addmap">+</button>

	<div class="contmaps slider slider-nav">
		<div><h4 class="mapLabel">Map 1</h4></div>
		<div><h4 class="mapLabel">Map 2</h4></div>
		<div><h4 class="mapLabel">3</h4></div>
		<div><h4 class="mapLabel">4</h4></div>
		<div><h4 class="mapLabel">5</h4></div>
		<div><h4 class="mapLabel">6</h4></div>
		<div><h4 class="mapLabel">7</h4></div>
		<div><h4 class="mapLabel">8</h4></div>
	</div>
		
	<button type="button" class="btn btn-light" id="addmap">-</button>
  </div>
</div>

<div class="modal fade" role="dialog" id="photosModal">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Photos manager</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body" id="modalBodyPic">
		<a href='#'> 
			<img src="style/img/add-camera.png" id="addPhotoBtn">
		</a>
	  </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-primary">Save changes</button>
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>

<script src="https://unpkg.com/axios/dist/axios.min.js"></script>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick.min.js"></script>
<script type="text/javascript">
	
	$('.contmaps').slick({
		infinite: true,
		slidesToShow: 5,
		slidesToScroll: 2,
		dots: true
	});
</script>
<script>
	var map = L.map('mapid').setView([48.85, 2.35], 13);
	L.tileLayer('http://{s}.tile.osm.org/{z}/{x}/{y}.png').addTo(map);

	L.marker([48.841, 2.355]).addTo(map)
		.bindPopup('Place X')
		.openPopup();
		
	function createButton(label, container) {
		var btn = L.DomUtil.create('button', 'addedbtn', container);
		btn.setAttribute('type', 'button');
		btn.innerHTML = label;
		return btn;
	}
	
	function addImage(fileInput, container) {
		if (fileInput.files.length >0) { 
			var file = fileInput.files[0]; 
			var reader  = new FileReader();
			reader.onload = function(e)  { 
				var image = document.createElement("img"); 
				image.src = e.target.result; 
				image.style.maxWidth = '300px'
				image.style.maxHeight = '300px' 
				
				container.appendChild(image); 
			}
			reader.readAsDataURL(file);			
		} 
		
	}	
			
	map.on('click', function(e) {
		var container = L.DomUtil.create('div'),
			contMark = L.DomUtil.create('div'),
			markBtn = createButton('Mark place', contMark);
		contMark.className = "markContainer";
		container.appendChild(contMark);
		
		var contLoc = L.DomUtil.create('div'),
		startBtn = createButton('Start from this location', contLoc), 
		destBtn = createButton('Go to this location', contLoc); 
		container.appendChild(contLoc);
			
		<!-- L.DomEvent.on(startBtn, 'click', function() { -->
			<!-- control.spliceWaypoints(0, 1, e.latlng); -->
			<!-- map.closePopup(); -->
		<!-- }); -->
		
		<!-- L.DomEvent.on(destBtn, 'click', function() { -->
			<!-- control.spliceWaypoints(control.getWaypoints().length - 1, 1, e.latlng); -->
			<!-- map.closePopup(); -->
		<!-- }); -->
				
		L.DomEvent.on(markBtn, 'click', function() {
			var contName = document.createElement("div");
			var labelName = L.DomUtil.create("label",'labelTitle',contName);
			labelName.innerHTML = "Place name";
			var inputName = document.createElement("input");
			inputName.type = "text";	
			contName.appendChild(inputName);
			container.appendChild(contName);
			
			var contMsg = document.createElement("div");
			var label = L.DomUtil.create("label",'labelTitle',contMsg);
			label.innerHTML = "Message";
			var inputMsg = document.createElement("textarea");
			inputMsg.rows = "4";
			inputMsg.maxLength = "160";
			inputMsg.cols = "35";
			contMsg.appendChild(inputMsg);
			container.appendChild(contMsg);
			
			var contPict = document.createElement("div");
			label = document.createElement("label");
			label.innerHTML = "Pictures";
			contPict.appendChild(label);			
			var pic = document.createElement("input");
			pic.type = "file";
			contPict.appendChild(pic);	
			container.appendChild(contPict);
			
			$('#addPhotoBtn').click(function(){ 
				var fileInput = document.createElement("input");
				fileInput.type = "file";
			
				$(fileInput).trigger('click'); 
				$(fileInput).change(function(){
					addImage(fileInput, document.querySelector("#modalBodyPic"));
				})		
			});
			
			var contValid = L.DomUtil.create('div'),
			okBtn = createButton('Validate', contValid); 
			contValid.className = "markContainer";
			container.appendChild(contValid);
			
			L.DomEvent.on(okBtn, 'click', function() {
				addImage(pic, document.querySelector("#modalBodyPic"));
				if (inputName.value != "") {   
					var newPopup = L.DomUtil.create('div');
					var n = L.DomUtil.create('div');
					n.style.textAlign = "center";
					var titlePop = L.DomUtil.create('label', '', n);
					titlePop.innerHTML = "<b>"+inputName.value+"</b>";
					newPopup.appendChild(n);
					if (inputMsg.value != ""){ 
						var m = L.DomUtil.create('div');
						var msgPop = L.DomUtil.create('label', '', m);
						msgPop.innerHTML = inputMsg.value+"<br />";
						newPopup.appendChild(m);
					}
					var seePicsBtn = L.DomUtil.create('button','',newPopup);
					seePicsBtn.innerHTML = "See photos";
					seePicsBtn.setAttribute("data-toggle", "modal");
					seePicsBtn.setAttribute("data-target", "#photosModal");
					
					var p = L.popup()
							.setContent(newPopup)
							.setLatLng(e.latlng);
							
					L.marker(e.latlng).addTo(map)
					.bindPopup(p) 
					.openPopup(); 
					
				}
				else {					
					labelName.style.color = "red";
					labelName.innerHTML = "Place name (essential)"
				}
			});
		
			markBtn.style.display = 'none';
		}); 
			
		   
		L.popup()
			.setContent(container)
			.setLatLng(e.latlng)
        .openOn(map);
				
	});
	L.Routing.control({
		waypoints: [
			L.latLng(48.74, 2.40),
			L.latLng(48.1, 2.36)
		]
	}).addTo(map);
		
	
</script>

<footer id="footer">
 <div class="row">
  <div class="col-sm-12">
   <h6 id="copyright">copyright Â© 2018 - GL</h6>
  </div>
 </div>
</footer>
<script src="bootstrap/dist/js/bootstrap.min.js"></script>
<script src="https://unpkg.com/axios/dist/axios.min.js"></script>
<script defer src="script/my_maps.js"></script>
</body>
</html>